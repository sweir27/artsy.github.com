<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Technology | Artsy Engineering]]></title>
  <link href="http://artsy.github.io/blog/categories/technology/atom.xml" rel="self"/>
  <link href="http://artsy.github.io/"/>
  <updated>2015-04-09T13:08:05-04:00</updated>
  <id>http://artsy.github.io/</id>
  <author>
    <name><![CDATA[Artsy]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Artsy's Technology Stack, 2015]]></title>
    <link href="http://artsy.github.io/blog/2015/03/23/artsy-technology-stack-2015/"/>
    <updated>2015-03-23T00:00:00-04:00</updated>
    <id>http://artsy.github.io/blog/2015/03/23/artsy-technology-stack-2015</id>
    <content type="html"><![CDATA[<p>Artsy has now grown past 100 team members and our Engineering organization is now 20 strong. For a brief overview of what the company has accomplished in the last two years, check out our <a href="http://2013.artsy.net">2013</a> and <a href="http://2014.artsy.net">2014</a> reviews.</p>

<p>This is a good opportunity to describe our updated technology stack. Last time <a href="/blog/2012/10/10/artsy-technology-stack">we did this</a> was when Artsy launched publicly in 2012.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/stats.png'></center>


<p>Three years ago Artsy was a classic <a href="http://rubyonrails.org">Ruby-on-Rails</a> monolith with a handful of adjacent processes and tools. We've since broken it up into many independent services, and continue to heavily be a Ruby and JavaScript shop, using Rails where appropriate, with native code on mobile devices and some JVM-based experiments in micro-services.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/languages.png'></center>




<!-- more -->


<p>What you see today when you go to <a href="https://www.artsy.net">www.artsy.net</a> is a website built with <a href="http://ezeljs.com">Ezel.js</a>, which is a boilerplate for <a href="http://backbonejs.org">Backbone</a> projects running on <a href="https://nodejs.org">Node</a> and using <a href="http://expressjs.com">Express</a> and <a href="http://browserify.org">Browserify</a>. The <a href="https://github.com/artsy/force-public">CoffeeScript code</a> is open-source. The mobile version of www.artsy.net is <a href="https://m.artsy.net">m.artsy.net</a> and is built on the same technology. Both run on <a href="http://heroku.com">Heroku</a> and use <a href="http://redis.io">Redis</a> for caching. Assets, including artwork images, are served from <a href="http://aws.amazon.com/s3/">Amazon S3</a> via the <a href="http://aws.amazon.com/cloudfront">CloudFront CDN</a>.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/artsy.png'></center>


<p>These web applications talk to a private Ruby API built with <a href="https://github.com/intridea/grape">Grape</a>, that serves JSON. We also have a more modern and better designed <a href="https://developers.artsy.net">public HAL+JSON API</a>. For historical reasons, both are hosted side-by-side on top of a big Rails app that used to be our original monolith. The API service runs on <a href="http://aws.amazon.com/opsworks">AWS OpsWorks</a> and retrieves data from several <a href="http://www.mongodb.com">MongoDB</a> databases hosted with <a href="https://www.compose.io">Compose</a>. It also uses <a href="http://lucene.apache.org/solr">Apache Solr</a>, <a href="https://www.elastic.co">Elastic Search</a> and <a href="https://www.google.com/cse">Google Custom Search</a>. The API service also heavily relies on <a href="http://memcached.org">Memcached</a>.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/developers.png'></center>


<p>Our partners upload artworks, artists and other metadata via a home-grown content-management system built entirely from scratch in 2014 on Ruby-on-Rails. This was a deliberate <a href="http://chris.eidhof.nl/posts/boring-choice.html">"boring"</a> choice that continues to serve us very well. We have adopted a common model for admin-type apps with a shared component library and a reusable UI, all implemented as Rails engines. Using these components we are able to quickly and easily compose beautiful and useful applications - we have built dedicated systems to manage fairs and auctions. We standardized on related services as well - for example, our customers interact with us via <a href="https://www.intercom.io">Intercom</a>. We're also experimenting with some new technologies in our internal apps, notably <a href="http://facebook.github.io/react">React</a>.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/cms.png'></center>


<p>Our family of mobile applications includes <a href="http://iphone.artsy.net">Artsy for iOS</a>, which is a hybrid app written in Objective-C, and a <a href="https://github.com/artsy/eidolon">bidding kiosk</a>, written in Swift. Both are open-source <a href="https://github.com/artsy/eigen">here</a> and <a href="https://github.com/artsy/eidolon">here</a>.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/folio.jpg'></center>


<p>A lot of data, including the artwork similarity graph that powers The Art Genome Project, is processed offline by a generic job engine, written in Ruby or by <a href="http://aws.amazon.com/elasticmapreduce">Amazon Elastic MapReduce</a>. We take data snapshots from MongoDB, run jobs on the data and export data back to the database. Other recently rewritten services include image processing, which creates thumbnails, image tiles for deep zoom and watermarks high quality JPEGs. Several new applications use <a href="http://www.postgresql.org">PostgreSQL</a>.</p>

<p>Various front-ends pipe data to <a href="https://github.com/snowplow/snowplow">Snowplow</a> and <a href="https://segment.com">Segment</a>, which forwards events to <a href="https://keen.io">Keen</a>, <a href="http://www.google.com/analytics">Google Analytics</a>, <a href="https://mixpanel.com">MixPanel</a> and <a href="https://chartbeat.com">ChartBeat</a>. Some data is warehoused in <a href="http://aws.amazon.com/redshift">AWS Redshift</a> and <a href="http://www.postgresql.org">PostgreSQL</a> and may be analyzed offline using <a href="http://www.r-project.org">R</a> or <a href="http://ipython.org/notebook.html">iPython Notebooks</a>. We also have a <a href="https://github.com/etsy/statsd">Statsd</a> and <a href="http://graphite.wikidot.com">Graphite</a> system for tracking high volume, low-level counters. Finally, it's also fairly common to find a non-Engineer at Artsy in a read-only Rails console or in Redshift directly querying data.</p>

<p>We send millions of e-mails via <a href="http://sendgrid.com/">SendGrid</a> and <a href="https://mandrill.com">Mandrill</a> and use <a href="http://mailchimp.com">MailChimp</a> for manual campaigns.</p>

<p>Smaller systems usually start on <a href="https://dashboard.heroku.com">Heroku</a> and larger processes that perform heavier workloads usually end up on <a href="http://aws.amazon.com/opsworks">AWS OpsWorks</a>. Our systems are monitored by a combination of <a href="http://newrelic.com/">New Relic</a> and <a href="https://www.pingdom.com">Pingdom</a>. All of this is built, tested and continuously deployed with <a href="http://jenkins-ci.org">Jenkins</a>, <a href="https://semaphoreci.com">Semaphore</a>, and <a href="https://travis-ci.org">Travis-CI</a>.</p>

<center><img src='http://artsy.github.io/images/2015-03-23-artsy-technology-stack-2015/gravity.png'></center>


<p>In terms of Engineering workflow we live in <a href="https://github.com">Github</a> and <a href="https://trello.com">Trello</a>. We tend to have a workflow similar to open-source projects with individuals owning components and services and the entire team contributing to them.</p>

<p>In 2015 we intend to complete our transformation into small independent services built with 10x growth in mind. We can then focus on maturing the Artsy platform both vertically and horizontally and enabling many new directions for our thriving businesses.</p>

<p>We hope you find this useful and will be happy to describe any detailed aspect of our system on this blog. We're always hiring, please e-mail <a href='mailto:jobs@artsy.net'>jobs@artsy.net</a> if you want to work with us. Finally, we welcome any questions here and look forward to answering them below!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Artsy's Technology Stack]]></title>
    <link href="http://artsy.github.io/blog/2012/10/10/artsy-technology-stack/"/>
    <updated>2012-10-10T21:21:00-04:00</updated>
    <id>http://artsy.github.io/blog/2012/10/10/artsy-technology-stack</id>
    <content type="html"><![CDATA[<p>The public launch of Artsy via the <a href="http://www.nytimes.com/2012/10/09/arts/design/artsy-is-mapping-the-world-of-art-on-the-web.html">New York Times</a> is a good opportunity to describe our current technology stack.</p>

<p>What you see when you go to <a href="http://artsy.net">Artsy</a> is a website built with <a href="http://backbonejs.org/">Backbone.js</a> and written in <a href="http://coffeescript.org/">CoffeeScript</a>. It renders JSON data from <a href="http://rubyonrails.org/">Ruby on Rails</a>, <a href="https://github.com/intridea/grape">Ruby Grape</a> and <a href="http://nodejs.org/">Node.js</a> services. Text search is powered by <a href="http://lucene.apache.org/solr/">Apache Solr</a>. We also have an <a href="https://developer.apple.com/devcenter/ios/index.action">iOS</a> application that talks to the same back-end Ruby API. We run all our web processes on <a href="http://www.heroku.com/">Heroku</a> and all job queues on <a href="http://aws.amazon.com/">Amazon EC2</a>. Our data store is <a href="http://www.mongodb.org/">MongoDB</a>, operated by <a href="https://mongohq.com/">MongoHQ</a> and we have some <a href="http://redis.io/">Redis</a> instances. Our assets, including images, are served from <a href="http://aws.amazon.com/s3/">Amazon S3</a> via the <a href="http://aws.amazon.com/cloudfront/">CloudFront CDN</a>. We heavily rely on <a href="http://memcached.org/">Memcached</a> Heroku addon and we use <a href="http://sendgrid.com/">SendGrid</a> and <a href="http://mailchimp.com/">MailChimp</a> to send e-mail. Systems are monitored by a combination of <a href="http://newrelic.com/">New Relic</a> and <a href="https://www.pingdom.com/">Pingdom</a>. All of this is built, tested and deployed with <a href="http://jenkins-ci.org/">Jenkins</a>.</p>

<p><img src="http://artsy.github.io/images/2012-10-10-artsy-technology-stack/artsy-infrastructure.png"></p>

<p>In this post I'll go in depth in our current system architecture and tell you the story about how these parts all came together.</p>

<!-- more -->


<h2>Early Prototypes</h2>

<p>Artsy early prototypes in 2010 consisted of a combination of PHP and Java web services running on JBoss and backed by a MySQL database. The system had more similarities with a large transactional banking application than a consumer website.</p>

<p>In early 2011 we rebooted the project on Ruby on Rails. RDBMS storage was replaced with NoSQL MongoDB. A <a href="http://www.10gen.com/presentations/MongoNYC-2012/Using-MongoDB-to-Build-Artsy">video</a> was recorded at MongoNYC 2012 that goes in depth into this specific choice.</p>

<h2>Artsy Architecture Today</h2>

<p>Having only a handful of engineers, our goal has always been to keep the number of moving parts to an absolute minimum. With a few new engineers we were able to expand things a bit.</p>

<h2>Artsy Website Front-End</h2>

<p>The Artsy website is a responsive <a href="http://backbonejs.org/">Backbone.js</a> application written in <a href="http://coffeescript.org/">CoffeeScript</a> and <a href="http://sass-lang.com/">SASS</a> and served from a Rails back-end. The generated JavaScript and CSS files are packaged and compressed with <a href="http://documentcloud.github.com/jammit/">Jammit</a> and deployed to Amazon S3. The Rails app itself is a traditional MVC system that bootstraps application data and mostly serves SEO needs, such as meta tags, escaped fragments and page titles. Once the basic data has been rendered though, Backbone routing takes over and you're now navigating a client-side browser app with pushState support as available, swapping frames and rendering views using JST templates and JSON data returned from the API.</p>

<h2>Core API</h2>

<p>The website talks to the nervous system of Artsy, a RESTful API built in Ruby and <a href="https://github.com/intridea/grape">Grape</a>.</p>

<p>In the early days we did a ton of domain-driven design and spent a lot of time modeling concepts such as <em>artist</em> or <em>artwork</em>. The API has read and write behavior for all our domain concepts. Probably 70% of it is pure CRUD doing <a href="http://mongoid.org/">Mongoid</a> queries with a layer of access control in <a href="https://github.com/ryanb/cancan">CanCan</a> and cache partitioning and binding using <a href="http://confreaks.com/videos/986-goruco2012-from-zero-to-api-cache-w-grape-mongodb-in-10-minutes">Garner</a>.</p>

<h2>Search Autocomplete</h2>

<p>The first iteration of the website's text search was powered by <a href="https://github.com/artsy/mongoid_fulltext">mongoid_fulltext</a>. Today we run an <a href="http://lucene.apache.org/solr/">Apache Solr</a> master-slave environment hosted on EC2.</p>

<h2>Offline Indexes</h2>

<p>The indexes that serve complex queries like related artists/artworks and filtered searches of artworks are all built offline. Our index-building system runs continuously, repeatedly pulling data from our production system to build the most out-of-date index. All of the most current indexes are imported back into production by a daily batch process and we swap the old indexes out atomically using <a href="https://github.com/aaw/mongoid_collection_snapshot">mongoid_collection_snapshot</a>.</p>

<p>One of such indexes a <em>similarity graph</em> that we query to produce most similar results on the website, other indexes serve filtering needs, etc. We run these processes nightly.</p>

<h2>Admin Back-End and Partner CMS</h2>

<p>The Artsy CMS and the Admin system are two newer projects and serve the needs of our partners and our internal back-end needs, respectively. These are built on a thin <a href="http://nodejs.org">Node.js</a> server that proxies requests to our API using <a href="https://github.com/nodejitsu/node-http-proxy">node-http-proxy</a>. They consist of a client-side Backbone.js application with assets packaged with <a href="https://github.com/craigspaeth/nap">nap</a>. This is a lot like our website, but completely decoupled from the main Rails application and sharing the same technology for both client and server with CoffeeScript and <a href="http://jade-lang.com/">Jade</a>.</p>

<h2>Folio Partner App</h2>

<p>Artsy makes a free iOS application, called <a href="http://artsy.github.com/blog/categories/ios/">Folio</a>, which lets our partners display their inventory at art fairs.</p>

<p>Folio is a native iOS implementation. The interface is heavily skinned UIKit with CoreData for storage. Our network code was originally a thin layer on top of NSURLConnection, but for our forthcoming update, we’ve rewritten it to use <a href="https://github.com/AFNetworking/AFNetworking/">AFNetworking</a>. We manage external dependencies with <a href="https://github.com/CocoaPods/CocoaPods">CocoaPods</a>.</p>

<h2>Want More Specifics? Have Questions?</h2>

<p>We hope you find this useful and are happy to describe any aspect of our system on this blog. Please ask questions below, we’ll be happy to answer them.</p>
]]></content>
  </entry>
  
</feed>
